\setcounter{section}{0}
\section{Аналитическая часть}

\subsection{Составляющие компилятора}
Компилятор состоит из следующих составляющих подпрограмм:
\begin{itemize}
    \item Frontend компилятора отвечает за первичную обработку исходного кода и создание внутреннего представления программы. Он состоит из следующих частей:
    \begin{itemize}
        \item препроцессор;
        \item лексический анализатор;
        \item cинтаксический анализатор;
        \item семантический анализатор;
        \item генератор промежуточного представления;
    \end{itemize}
    \item Middle-end компилятора занимается оптимизацией и преобразованием промежуточного представления программы.
    \item Backend компилятора отвечает за генерацию целевого кода, который может быть выполнен на конкретной аппаратной платформе или виртуальной машине.
\end{itemize}

В данной работе функции Middle-end и Backend компилятора будут осуществляться библиотекой LLVM, поэтому рассмотрим более подробно Frontend составляющих компилятора.


\subsubsection{Препроцессор}
Препроцессор компилятора - это компонент компилятора, который выполняет предварительную обработку исходного кода перед фазой фронтенда. Его задача заключается в обработке директив препроцессора и внесении соответствующих изменений в исходный код.

Препроцессор предоставляет набор директив, которые позволяют включать или исключать определенные части исходного кода, задавать макросы для замены текста и включать заголовочные файлы. Примером директив языка Си являются \textbf{include}, \textbf{define}, \textbf{pragma}. После работы препроцессора изменённый исходный код программы подаётся на вход лексический анализатора.

В данном проекте препроцессор не используется ввиду его избыточности.

\subsubsection{Лексический анализатор}
Лексический анализатор выполняет первичную обработку исходного кода, разбивая его на лексемы. Лексема - минимальный элемент исходного кода. Примеры: ключевые слова, идентификаторы, операторы, константы и символы пунктуации.

Задачи лексического анализатора:
\begin{itemize}
    \item разбиение исходного кода на лексемы;
    \item идентификация типов лексем;
    \item удаление незначащих символов;
    \item формирование потока токенов для синтаксического анализатора;
\end{itemize}

\subsubsection{Синтаксический анализатор}

Синтаксический анализатор выполняет построение синтаксического дерева из полученного потока токенов, которое представляет иерархическую структуру программы. Обычно это представление выражается в виде абстрактного синтаксического дерева (АСТ), где каждый внутренний узел является оператором, а дочерние его аргументами.

Задачи синтаксического анализатора:
\begin{itemize}
    \item проверка синтаксической корректности (соответствие грамматике);
    \item построение синтаксического дерева;
    \item обработка ошибок.
\end{itemize}

Полученное представление программы в виде синтаксического дерева используется на следующем этапе. 

\subsubsection{Семантический анализ}
Семантический анализатор выполняет проверку семантики исходного кода, включая правильное использование типов данных, правила области видимости и согласованность операций. 

Задачи семантического анализатора:
\begin{itemize}
    \item установить семантическую связь между различными частями программы;
    \item выявить потенциальные ошибки и несоответствия типов.
\end{itemize}

Семантический анализатор составляет таблицу символов, описывающую хранящиеся типы данных.

\subsubsection{Генерация кода}
Генерация кода - это фаза компиляции, в которой основываясь на синтаксическом дереве программы и системных таблиц создаётся её код.

Получение машинного кода осуществляется в два этапа.
\begin{enumerate}
    \item Генерация промежуточного кода - относится к последней фазе frontend компилятора.
    \item Генерация машинного кода - относится к middle-end и backend компилятора.
\end{enumerate}

Основные этапы генерации кода включают:
\begin{itemize}
    \item оптимизация промежуточного представления;
    \item выбор инструкций целевой платформы, соотвествующие промежуточному представлению;
    \item связывание данных с именами переменных;
    \item собственно генерация кода.
\end{itemize}

Результатом этого этапа является исполняемый на целевой платформе код.

\subsection{ANTLR4}
В качестве лексического и синтаксического анализатора будет использован ANTLR4 (ANother Tool for Language Recognition). Выбор обосновывается рядом преимуществ и особенностей данного инструмента:

\begin{itemize}
    \item поддержка генерацию лексических и синтаксических анализаторов для широкого спектра языков программирования;
    \item удобный и интуитивно понятный синтаксис для описания грамматик языков программирования;
    \item автоматическая генерация синтаксического дерева;
    \item широкая и активная пользовательская база и развитое сообщество разработчиков.
\end{itemize}

\subsection{LLVM}
В качестве генератора кода используется LLVM (Low Level Virtual Machine). Его выбор обосновывается следующими факторами:

\begin{itemize}
    \item Поддержка большого количества целевых платформ.
    \item Поддержка библиотек на различных языках (С, C++, Rust, Python и другие).
    \item Поддержка основных типы данных: целые числа, числа с плавающей точки различных точностей, массивы, структуры, функции.
    \item Автоматическая оптимизация сгенерированного промежуточного представления.
    \item Широкая и активная пользовательская база и развитое сообщество разработчиков.
    \item Имеется интерпретатор промежуточного представления.
\end{itemize}

\subsection*{Выводы}
В данном разделе был проведён обзор основных фаз компиляции. Обоснованы выборы средств лексического и синтаксического анализа - ANTLR4 и генератора машинного кода - LLVM. Метод работы компилятора будет заключаться в генерации синтаксического дерева и генерации по нему промежуточного представления кода (LLVM IR).
